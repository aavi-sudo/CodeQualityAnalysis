# Fortune Teller Server

## Program Requirements for Server: 

The Server for the Fortune teller must: 
- Be implemented as a `daemon` (i..e., has no command line arguments or menu -has  no interface).
- Listen on the specific assigned `TCP port number` and accepts the connections (Port number is calculated as **`11000 + last three digits of ID number`)**.
- Accept a `yes/no style question` from the client (the messages are ASCII - plain text).
- `Randomly select from the twenty predefined set of possible respones (using arc4random_uniform(3) function to generate a random number)` and generate a reply to client's question.
- `Format the response` include the question and randomly selected answer when sending the response back to the client.
- `Continue listening` after each connection is processed until it is killed.
- `Handle errors gracefully`, which means program should recover from different errors and continue running if possible, otherwise the server should display an informative message on the screen stating the error and clean up the resources and then lead to termination.
- Support shutdown be handeled by sending a **`CTRL-C (SIGINT)`** to the server from the console. 

## Program Inputs: 
- Incoming TCP connections on the specific port.
- Yes/No style questions from client that are plain text (ASCII) format;
    - **Allowed characters:** A-Z, a-z, 0-9, punctuation & symbols, and whitespace.
    - **Allowed length:** 512 bytes

## Program Outuputs: 
- To work gracefully the server must print **informative error messages** on the screen if encountered any error.


## Test Plan: 


| #  |   Test Case                | Description                                                   | Input                       | Expected Output                           |
|----|----------------------------|---------------------------------------------------------------|-----------------------------|-------------------------------------------|
| 1  | **Basic yes/no question**  | Understanding basic working of model                          |`"Are you fine?"`            | `Q: "Are you fine?" R: "random response"` |
| 2  | **Input Exceeds length**   | Testing how it handles an input that is greater than 512 bytes|`"aaaaaaaaaaaaa" > 512 bytes`| `Inputs exceeds expected length limit`    |
| 3  | **Port Issue**             | Check working when port is in use                             | `-`                         | `"ERROR: PORT IN USE"`                    |                      
| 4  | **Shutdown check**         | Ensure server shuts down gracefully                           | `CTRL+C`                    | `Server shuts down`                       |
| 5  | **Random function check**  | Ensure random function works correctly                        | `Repeat questions`          | `Different possible response each time`   |

## Design Overview: 
1. ` Create a TCP socket` using the socket() function for the communication, if the programs fails to create a socket, display an appropriate error message on the screen and exits.
2. `Bind the socket to the specific port number` as generated by the id number using bind() function, if binding fails (say if port is already in use) server prints and error message, closes the socket and exits.
3. Next step will be to `wait for the incoming connection for the socket which will be done using the listen() function`.If the server fails to listen for a connection, it displays an error message, closes the socket and exits.
4. Once a conncetion has been recieved, `accept the incoming connections` using the accept() function, close the socket and print an error message if accept() fails.
5. Once the connection has been made, now `read the yes/no style question sent by the client` using recv() function, display an error message and close the socket if rec() fails.
6. Generate a random number and `select from one of the possible 20 responses` using arc4random_uniform(3) function.
7. `Format the responses ` as required.
8. Use the send() function to `send the formatted message back to the client`, display an error if sending falis, close the socket and exit.
9. `Close the client socket connection` using the close() function.


 
